#!/usr/bin/env python3
"""
Flights scheduler script for Railway cron service.
This script handles scheduled flight price monitoring tasks.
"""
import sys
import os
from datetime import datetime

# Add shared library to path
sys.path.insert(0, os.path.join(os.path.dirname(__file__), '..', '..'))

from shared.services.flights import FlightsService


def main():
    """Main function that executes the scheduled flight monitoring job."""
    print("=== Flights Scheduler Job Started ===")
    print(f"Timestamp: {datetime.now().isoformat()}")

    try:
        # Initialize flights service
        flights_service = FlightsService()

        # TODO: Add your flight monitoring logic here
        # For now, just print that the job is working
        print("Job is working")
        print("Flight monitoring task executed successfully")
        
        # Example: Get flights data
        # flights_data = flights_service.getFlights()
        # print(f"Found {len(flights_data.get('flights', []))} flights")

        # Example of what you might do:
        # - Check for new flight deals
        # - Update flight prices in database
        # - Send alerts for price drops
        # - Clean up old data

        print("=== Flights Scheduler Job Completed ===")

    except Exception as e:
        print(f"Error in flights scheduler: {e}")
        print("=== Flights Scheduler Job Failed ===")
        sys.exit(1)


if __name__ == "__main__":
    main()
